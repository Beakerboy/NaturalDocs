<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Manager.cs</title><link rel="stylesheet" type="text/css" href="../../styles/main.css" /><script type="text/javascript" src="../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="CodeClear.NaturalDocs.Engine.Links.Manager"></a><a name="Topic2030"></a><div class="CTopic TClass LCSharp first">
 <div class="CTitle"><span class="Qualifier">CodeClear.&#8203;NaturalDocs.&#8203;Engine.&#8203;Links.</span>&#8203;Manager</div>
 <div class="NDClassPrototype HasParents" id="NDClassPrototype2030"><a class="CPEntry Parent TClass" href="../../index.html#File2:Module.cs:CodeClear.NaturalDocs.Engine.Module" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3865);" onmouseout="NDContentPage.OnLinkMouseOut(event);" ><div class="CPName"><span class="Qualifier">CodeClear.&#8203;NaturalDocs.&#8203;Engine.</span>&#8203;Module</div></a><a class="CPEntry Parent TInterface" href="../../index.html#File2:CodeDB/IChangeWatcher.cs:CodeClear.NaturalDocs.Engine.CodeDB.IChangeWatcher" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,123);" onmouseout="NDContentPage.OnLinkMouseOut(event);" ><div class="CPName"><span class="Qualifier">CodeClear.&#8203;NaturalDocs.&#8203;Engine.&#8203;CodeDB.</span>&#8203;IChangeWatcher</div></a><div class="CPEntry TClass Current"><div class="CPModifiers"><span class="SHKeyword">public</span></div><div class="CPName"><span class="Qualifier">CodeClear.&#8203;NaturalDocs.&#8203;Engine.&#8203;Links.</span>&#8203;Manager</div></div></div>
 <div class="CBody"><p>A module that manages scoring links.&nbsp; Links and their targets are still stored in <a href="../../index.html#File2:CodeDB/Manager.cs:CodeClear.NaturalDocs.Engine.CodeDB.Manager" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,49);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >CodeDB.Manager</a>, but this handles the logic of determining how well each link and target match and generating scores for them.</p><p>Multithreading: Thread Safety Notes</p><pre>linksToResolve<br />newTopicIDsByEndingSymbol</pre><p>Externally, this class is thread safe.</p><p>Internally, both <a href="../../index.html#File2:Links/Manager.cs:CodeClear.NaturalDocs.Engine.Links.Manager.linksToResolve" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2035);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >linksToResolve</a> and <a href="../../index.html#File2:Links/Manager.cs:CodeClear.NaturalDocs.Engine.Links.Manager.newTopicIDsByEndingSymbol" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2036);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >newTopicIDsByEndingSymbol</a> are locked independently with monitors.&nbsp; Currently the locks do not need to be held simultaneously for any reason so there is no locking order.&nbsp; That means do not attempt to lock one while holding the other, period.</p><pre>beforeFirstResolve</pre><p><a href="../../index.html#File2:Links/Manager.cs:CodeClear.NaturalDocs.Engine.Links.Manager.beforeFirstResolve" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2037);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >beforeFirstResolve</a> is currently only used for optimization in the parsing stage to limit the amount of work to be done in the resolving stage on a full reparse.&nbsp; <a href="../../index.html#File2:Links/Manager.Resolving.cs:CodeClear.NaturalDocs.Engine.Links.Manager.WorkOnResolvingLinks" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2040);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorkOnResolvingLinks()</a> immediately sets it to false before doing any work and no code in that or later stages references it.&nbsp; As such it is not governed by a lock since the only race condition it could introduce would be if a full reparse and link resolving were occuring simultaneously, which they won't.</p><p>If this variable is used in any other way or this assumption is no longer correct, the locking mechanism for this variable will have to be revisited.</p></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.Manager"></a><a name="Topic2031"></a><div class="CTopic TFunction LCSharp">
 <div class="CTitle">Manager</div>
 <div id="NDPrototype2031" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">public</span> Manager (</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><a href="../../index.html#File2:Instance.cs:CodeClear.NaturalDocs.Engine.Instance" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3962);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Engine.</a></td><td class="PType"><a href="../../index.html#File2:Instance.cs:CodeClear.NaturalDocs.Engine.Instance" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3962);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Instance</a>&nbsp;</td><td class="PName last">engineInstance</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.Start"></a><a name="Topic2032"></a><div class="CTopic TFunction LCSharp">
 <div class="CTitle">Start</div>
 <div id="NDPrototype2032" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">public</span> <span class="SHKeyword">bool</span> Start (</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><a href="../../index.html#File2:Errors/ErrorList.cs:CodeClear.NaturalDocs.Engine.Errors.ErrorList" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1160);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >ErrorList</a>&nbsp;</td><td class="PName last">errorList</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.Dispose"></a><a name="Topic2033"></a><div class="CTopic TFunction LCSharp">
 <div class="CTitle">Dispose</div>
 <div id="NDPrototype2033" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">protected override</span> <span class="SHKeyword">void</span> Dispose (</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">bool</span>&nbsp;</td><td class="PName last">strictRulesApply</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.Variables"></a><a name="Topic2034"></a><div class="CTopic TGroup LCSharp">
 <div class="CTitle">Variables</div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.linksToResolve"></a><a name="Topic2035"></a><div class="CTopic TVariable LCSharp">
 <div class="CTitle">linksToResolve</div>
 <div id="NDPrototype2035" class="NDPrototype NoParameterForm"><span class="SHKeyword">protected</span> <a href="../../index.html#File2:IDObjects/NumberSet.cs:CodeClear.NaturalDocs.Engine.IDObjects.NumberSet" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1517);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >IDObjects.NumberSet</a> linksToResolve</div>
 <div class="CBody"><p>The IDs of all the links that need to be resolved, either because they're new or their previous target was deleted.&nbsp; Note that this is not the complete set of all unresolved links; some links may have previously resolved to nothing and there may have been no changes made that could affect them.</p><div class="CHeading">Thread Safety</div><p>This variable should always be locked with a monitor before using.</p></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.newTopicIDsByEndingSymbol"></a><a name="Topic2036"></a><div class="CTopic TVariable LCSharp">
 <div class="CTitle">newTopicIDsByEndingSymbol</div>
 <div id="NDPrototype2036" class="NDPrototype NoParameterForm"><span class="SHKeyword">protected</span> <a href="../../index.html#File2:Collections/SafeDictionary.cs:CodeClear.NaturalDocs.Engine.Collections.SafeDictionary" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,276);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >SafeDictionary</a>&lt;<a href="../../index.html#File2:Symbols/EndingSymbol.cs:CodeClear.NaturalDocs.Engine.Symbols.EndingSymbol" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3191);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Symbols.EndingSymbol</a>, <a href="../../index.html#File2:IDObjects/NumberSet.cs:CodeClear.NaturalDocs.Engine.IDObjects.NumberSet" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1517);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >IDObjects.NumberSet</a>&gt; newTopicIDsByEndingSymbol</div>
 <div class="CBody"><p>Keeps track of all newly created <a href="../../index.html#File2:Topics/Topic.cs:CodeClear.NaturalDocs.Engine.Topics.Topic" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3611);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Topics</a>.&nbsp; The keys are the <a href="../../index.html#File2:Symbols/EndingSymbol.cs:CodeClear.NaturalDocs.Engine.Symbols.EndingSymbol" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3191);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Symbols.EndingSymbols</a> the topics use, and the values are <a href="../../index.html#File2:IDObjects/NumberSet.cs:CodeClear.NaturalDocs.Engine.IDObjects.NumberSet" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,1517);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >IDObjects.NumberSets</a> of all the topic IDs associated with that ending symbol.&nbsp; This is used for resolving links.</p><div class="CHeading">Thread Safety</div><p>This variable should always be locked with a monitor before using.</p><div class="CHeading">Rationale</div><p>When a new <a href="../../index.html#File2:Topics/Topic.cs:CodeClear.NaturalDocs.Engine.Topics.Topic" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3611);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Topic</a> is created, it might serve as a better definition for existing links.&nbsp; We don't want to reresolve the links as soon as the topic is created because there may be multiple topics that affect the same links and we'd be wasting effort.&nbsp; Instead we store which topics are new and resolve the links after parsing is complete.</p><p>We can't store the <a href="../../index.html#File2:Topics/Topic.cs:CodeClear.NaturalDocs.Engine.Topics.Topic" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3611);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Topic</a> objects themselves because when doing a non-differential run every topic will be new and we'd end up storing the entire documentation structure in memory.&nbsp; Instead we store the topic IDs and look up the <a href="../../index.html#File2:Topics/Topic.cs:CodeClear.NaturalDocs.Engine.Topics.Topic" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,3611);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >Topics</a> again when it's time to resolve links.</p><p>We store them by ending symbol instead of in one NumberSet so that we can reresolve links in batches.&nbsp; Topics that have the same ending symbol will be candidates for the same group of links, so we can query those topics and links into memory, reresolve them all at once, and then move on to the next ending symbol.&nbsp; If we stored a single NumberSet of topic IDs we'd have to handle the topics one by one and query for each topic's links separately.</p></div>
</div>

<a name="CodeClear.NaturalDocs.Engine.Links.Manager.beforeFirstResolve"></a><a name="Topic2037"></a><div class="CTopic TVariable LCSharp last">
 <div class="CTitle">beforeFirstResolve</div>
 <div id="NDPrototype2037" class="NDPrototype NoParameterForm"><span class="SHKeyword">private</span> <span class="SHKeyword">bool</span> beforeFirstResolve</div>
 <div class="CBody"><p>Wheher we haven't called <a href="../../index.html#File2:Links/Manager.Resolving.cs:CodeClear.NaturalDocs.Engine.Links.Manager.WorkOnResolvingLinks" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2040);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorkOnResolvingLinks()</a> yet this execution.</p><div class="CHeading">Thread Safety</div><p>This variable is currently only used for optimization in the parsing stage to limit the amount of work to be done in the resolving stage on a full reparse.&nbsp; <a href="../../index.html#File2:Links/Manager.Resolving.cs:CodeClear.NaturalDocs.Engine.Links.Manager.WorkOnResolvingLinks" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,2040);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >WorkOnResolvingLinks()</a> immediately sets it to false before doing any work and no code in that or later stages references it.&nbsp; As such it is not governed by a lock since the only race condition it could introduce would be if a full reparse and link resolving were occuring simultaneously, which they won't.</p><p>If this variable is used in any other way or this assumption is no longer correct, the locking mechanism for this variable will have to be revisited.</p></div>
</div>

</body></html>